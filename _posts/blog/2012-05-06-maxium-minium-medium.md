---
layout: post
title:  最大值、最小值和中位数
category: blog
description: 不管是在面试中，还是在工作中我们都会遇到求最大值、最小值和中位数的问题，下面是个人觉得涵盖了这些知识的、很全面的一个问题。
---

## 问题 ##
不管是在面试中，还是在工作中我们都会遇到求最大值、最小值和中位数的问题，下面是个人觉得涵盖了这些知识的、很全面的一个问题：

> 建立一个堆栈，这个堆栈支持如下五个操作：
> 
> pop()：出栈
> 
> push()：入栈
> 
> getMaxium()：取最大值
> 
> getMinium()：取最小值
> 
> getMedium()：最中位数

> 如果设计这五个操作，并使他们的代价最小？

## 假设 ##
我们假设：当前堆栈中已有数的个数为n，堆栈中的数据是动态变化的，我们统计单次调用pop()、push()、getMaxium()、getMinium()、getMedium()五个操作所产生的时间复杂度。根据pop()、push()、getMaxium()、getMinium()、getMedium()五个操作使用的频繁程度，可有如下方法：

## 方法一： ##
如果pop()、push()、getMaxium()、getMinium()操作调用频度高，而getMedium()调用频度低。

可以使用的方法是建立一个正常的堆栈，也就是说具有pop()、push()功能，它们的时间复杂度是O(1)；

然后用一个数组记录当前堆栈的最大值/最小值的位置（这个数组可以想象成一个记录最大值/最小值的堆栈，与当前堆栈同步变化），在push()操作时增加push元素后的最大值，这样我们就有了getMaxium()、getMinium() O(1)时间的算法；

getMedium()直接遍历堆栈，当做求解一个数组的第k大数来求解，算法的时间复杂度是O(n)。目前我还没有想到比O(n)更好的算法，如果你想到了，请告诉我。

## 综上： ##
空间复杂度为：

O(n);

时间复杂度为：

操作	时间复杂度

pop()	O(1)

push()	O(1)

getMaxium()	O(1)

getMinium()	O(1)

getMedium()	O(n)

## 方法二： ##
在方法一的基础上，push、pop时，维护一个排好序的数组，维护代价是O(n)。

空间复杂度为：

O(n);

时间复杂度为：

操作	时间复杂度

pop()	O(n)

push()	O(n)

getMaxium()	O(1)

getMinium()	O(1)

getMedium()	O(1)

## 方法三： ##
如果pop()、push()操作调用频度低，而getMaxium()、getMinium()、getMedium()调用频度高。

建立一个大顶堆存储前(N+1)/2小的元素，建立一个小顶堆存储后N/2大的元素，维护这两个堆，并记录这两个堆的元素的个数i、j，堆顶的值分别为P、Q，后面介绍它们的用法；

在建立上述堆的同时，利用链表构建堆中元素的插入顺序关系来支持pop()、push()操作。

设push的元素大小为M，更新的策略是：

当只有一个数时，特殊处理，放到大顶堆；

当i<=j时，M<=Q，M插入大顶堆，如果M>Q，把Q从小顶堆中删除、并插入大顶堆，然后把M插入小顶堆；

当i>j时，如果M<=P，把P从大顶堆中删除、并插入小顶堆，然后把M插入大顶堆，如果M>P，把M插入小顶堆；

同理，可以得到pop一个元素的更新策略，这里不再赘述。通过上述过程，我们push或pop一个元素的时间复杂度是O(1)，但是还需要O(logN/2)时间来做堆的更新，得到中位数的时间复杂度是：O(1)。

再次，我们可以再分别建立一个N个元素的大顶堆以便获取最大值，建立一个小顶堆以便获取最小值。另外，可以也可以通过方法一的方式，用一个数组记录当前堆栈栈顶的最大值/最小值的位置，以减小时间复杂度的因子。

## 综上： ##
空间复杂度为：

O(n);

时间复杂度为：

操作	时间复杂度

pop()	O(logN/2)

push()	O(logN/2)

getMaxium()	O(1)

getMinium()	O(1)

getMedium()	O(1)

## 方法四： ##
平衡二叉搜索树（BST）。即维护一个根节点的左子树和右子树个数相差不超过1的二叉搜索树。

与方法三类似：

空间复杂度为：

O(n);

时间复杂度为：

操作	时间复杂度

pop()	O(logN)

push()	O(logN)

getMaxium()	O(1)

getMinium()	O(1)

getMedium()	O(1)

## 更多 ##
欢迎大家对文章内容进行批评指导，如果你有更好的方法，请留下评论或者联系我。

为了首尾呼应，结尾也吐槽一下：舍友Kitty说我在聊很多事情的时候，都喜欢升华一下，比如扯到了爱情/哲学云云。哎，最近道路坎坷、跌跌撞撞，正处涅槃期，想不这么深沉和感慨都不行啊。这里还是先放一下节操，再范一次旧病：做人要有特色，不能太中庸，最大值、最小值很容易被别人辨认出来，中位数就难了。：）